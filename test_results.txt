Traceback (most recent call last):
  File "/home/defaut/reconflow/reconflow/test_suite.py", line 33, in run_test
    test_func()
  File "/home/defaut/reconflow/reconflow/test_suite.py", line 82, in test_schema_validation_invalid_type
    validate_yaml(invalid_data)
  File "/home/defaut/reconflow/reconflow/core/schema.py", line 74, in validate_yaml
    raise ValueError(f"Unknown or unsupported type: {data['type']}. Only 'module' is supported.")
ValueError: Unknown or unsupported type: invalid. Only 'module' is supported.
Traceback (most recent call last):
  File "/home/defaut/reconflow/reconflow/test_suite.py", line 200, in test_strict_variable_enforcement
    raise AssertionError("Should fail on undefined variable")
AssertionError: Should fail on undefined variable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/defaut/reconflow/reconflow/test_suite.py", line 33, in run_test
    test_func()
  File "/home/defaut/reconflow/reconflow/test_suite.py", line 203, in test_strict_variable_enforcement
    assert 'undefined_var' in str(e) or 'Template rendering failed' in str(e)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
Traceback (most recent call last):
  File "/home/defaut/reconflow/reconflow/test_suite.py", line 33, in run_test
    test_func()
  File "/home/defaut/reconflow/reconflow/test_suite.py", line 339, in test_project_repository
    projects = repo.list()
               ^^^^^^^^^
AttributeError: 'ProjectRepository' object has no attribute 'list'
======================================================================
ReconFlow Comprehensive Test Suite
======================================================================
Started: 2026-01-29 15:32:42.023626


[SCHEMA VALIDATION TESTS]
✅ PASS: Schema Validation - Valid Module
❌ FAIL: Schema Validation - Invalid Type
   Error: Unknown or unsupported type: invalid. Only 'module' is supported.
✅ PASS: Schema Step Validation

[MODULE EXECUTION TESTS]
✅ PASS: Module Loading
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/test/echo.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...{{inputs.filename}}'}}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[+] Registered module: /module/demo-ping
[+] Registered module: /module/mock-tool
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/custom/mock_tool.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...}/{{inputs.outfile}}'}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[*] Executing Tool 'step1': echo test
✅ PASS: Module Execution
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/test/echo.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...{{inputs.filename}}'}}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[+] Registered module: /module/demo-ping
[+] Registered module: /module/mock-tool
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/custom/mock_tool.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...}/{{inputs.outfile}}'}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[!] Template rendering failed for arguments in 'fail_step': 'undefined_var' is undefined
[!] Step 'fail_step' failed: 'undefined_var' is undefined
❌ FAIL: Strict Variable Enforcement
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/test/echo.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...{{inputs.filename}}'}}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[+] Registered module: /module/demo-ping
[+] Registered module: /module/mock-tool
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/custom/mock_tool.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...}/{{inputs.outfile}}'}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[*] Executing Tool 'custom_path': /tmp/mock_test_tool.sh 
✅ PASS: Tool Path Option
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/test/echo.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...{{inputs.filename}}'}}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[+] Registered module: /module/demo-ping
[+] Registered module: /module/mock-tool
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/custom/mock_tool.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...}/{{inputs.outfile}}'}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[*] Executing Tool 'sleep1': sleep 0.5
[*] Executing Tool 'sleep2': sleep 0.5
[*] Executing Tool 'final': echo done
✅ PASS: Parallel Execution

[CONTEXT & MANAGER TESTS]
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/test/echo.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...{{inputs.filename}}'}}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
[+] Registered module: /module/demo-ping
[+] Registered module: /module/mock-tool
Failed to load YAML module /home/defaut/reconflow/reconflow/modules/custom/mock_tool.yml: 1 validation error for ModuleSchema
info
  Field required [type=missing, input_value={'type': 'module', 'metad...}/{{inputs.outfile}}'}]}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
✅ PASS: Context Initialization
✅ PASS: ToolManager Loading
✅ PASS: ToolManager Search

[DATABASE TESTS]
✅ PASS: Database Session
❌ FAIL: Project Repository
   Error: 'ProjectRepository' object has no attribute 'list'

[UTILITY TESTS]
✅ PASS: Path Utilities
15:32:43 - reconflow - INFO - Test log message
✅ PASS: Logger

[CLI COMMAND TESTS]
✅ PASS: CLI Commands Import

======================================================================
TEST SUMMARY
======================================================================
✅ Passed: 13
❌ Failed: 3
⊘  Skipped: 0

Failed Tests:
  - Schema Validation - Invalid Type: Unknown or unsupported type: invalid. Only 'module' is supported.
  - Strict Variable Enforcement: 
  - Project Repository: 'ProjectRepository' object has no attribute 'list'

Completed: 2026-01-29 15:32:43.414792
======================================================================
