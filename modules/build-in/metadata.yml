type: module
info:
  id: metadata-analyer
  name: metadata-analyer 
  tag: recon
  description: >
    discover metadata for target 
  author: default
vars:
  target:
    required: false
    description: target name  
  targets:
    required: false
    description: path to targets wordlist
  aggression:
    required: false
    description: aggression level (1=stealthy, 3=aggressive, 4=heavy)
    default: 3
  screenshot:
    required: false
    type: boolean
steps:
  - name: metadata-analyer
    tool: metadata.py
    args: " {-l {{targets}}||-t {{target}}} -a {{aggression}}  "
  - name: screenshot
    tool: bash
    args: "-c '{cat {{targets}}||echo {{target}}} | aquatone '"
    condition: "{screenshot == true}"
  - name: rm 
    tool: rm 
    args: '-rf http*'
    depends_on: [metadata-analyer]
