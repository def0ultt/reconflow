type: module
info:
  id: recon-openredirect
  name: Open Redirect Detection
  tag: Scan
  description: test for open redirects
  author: charlie
vars:
  urls:
    required: true
  payloads:
    default: "/home/defaut/toolkit/web/loxs/payloads/or.txt"
  header:
    default: "User-Agent: Mozilla/5.0"
    description: custem header 
steps:
  - name: inject_payloads
    tool: /bin/bash
    args: "-c 'cat {{payloads}} | while read payload; do cat {{urls}} | zap \"$payload\"; done'"
    timeout: "1h"
  - name: httpx_test
    tool: httpx
    args: " -fr -mr 'google.com' -location -H '{{header}}' -random-agent   "
    stdin: true
    depends_on: [inject_payloads]
